{
  "kind": "build_request",
  "title": "Increase file upload size limits across all post creation flows",
  "projectName": "RevGrid",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-68",
      "text": "Increase the maximum allowed file size on CreateFeedPostPage (frontend/src/pages/CreateFeedPostPage.tsx) from the current ~1.5 MB cap to at least 10 MB. Update the file size validation guard and the user-facing error message to reflect the new limit (e.g., 'File too large — please select a file under 10 MB'). The base64 encoding and submission flow must continue to work correctly for larger files.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Increase the photo upload size and all that all the post sizes like for machanics etc etc"
        ]
      },
      "acceptanceCriteria": [
        "CreateFeedPostPage accepts image files up to 10 MB without rejecting them",
        "Files larger than 10 MB are rejected with a clear user-facing error message stating the limit",
        "The error message reflects the new 10 MB limit",
        "Base64 encoding and post submission work correctly for files up to 10 MB"
      ]
    },
    {
      "id": "REQ-69",
      "text": "Increase the maximum allowed file size on CreateMechanicQuestionPage (frontend/src/pages/CreateMechanicQuestionPage.tsx) to at least 10 MB. Add or update the file size validation guard on any image file input present, reject files exceeding the limit with a clear user-facing error message (e.g., 'File too large — please select a file under 10 MB'), and ensure the base64 encoding and submission flow works correctly for larger files.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Increase the photo upload size and all that all the post sizes like for machanics etc etc"
        ]
      },
      "acceptanceCriteria": [
        "CreateMechanicQuestionPage accepts image files up to 10 MB",
        "Files larger than 10 MB are rejected with a clear user-facing error message stating the 10 MB limit",
        "Base64 encoding and submission work correctly for files up to 10 MB"
      ]
    },
    {
      "id": "REQ-70",
      "text": "Increase the maximum allowed file size on CreateBuildPage (frontend/src/pages/CreateBuildPage.tsx) to at least 10 MB per image. Add or update the file size validation guard on all image file inputs, reject files exceeding the limit with a clear user-facing error message (e.g., 'File too large — please select a file under 10 MB'), and ensure the base64 encoding and submission flow works correctly for larger files.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Increase the photo upload size and all that all the post sizes like for machanics etc etc"
        ]
      },
      "acceptanceCriteria": [
        "CreateBuildPage accepts image files up to 10 MB per image input",
        "Files larger than 10 MB are rejected with a clear user-facing error message stating the 10 MB limit",
        "Base64 encoding and submission work correctly for files up to 10 MB"
      ]
    },
    {
      "id": "REQ-71",
      "text": "Increase the maximum allowed file size on CreateListingPage (frontend/src/pages/CreateListingPage.tsx) from the current ~1.5 MB cap to at least 10 MB. Update the file size validation guard and the user-facing error message to reflect the new limit. The base64 encoding and submission flow must continue to work correctly for larger files.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Increase the photo upload size and all that all the post sizes like for machanics etc etc"
        ]
      },
      "acceptanceCriteria": [
        "CreateListingPage accepts image files up to 10 MB",
        "Files larger than 10 MB are rejected with a clear user-facing error message stating the 10 MB limit",
        "Base64 encoding and submission work correctly for files up to 10 MB"
      ]
    },
    {
      "id": "REQ-72",
      "text": "Update the backend createPost function in backend/main.mo to ensure it does not trap or return an error for mediaData (base64-encoded text) payloads up to the ICP ingress message limit (~2 MB per call). Remove any artificial size cap or assertion on the mediaData or imageUrl Text fields. Add a comment documenting the effective payload limit. This ensures the backend is consistent with the increased frontend file size limits.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Increase the photo upload size and all that all the post sizes like for machanics etc etc"
        ]
      },
      "acceptanceCriteria": [
        "The backend createPost function does not trap on mediaData payloads up to the ICP ingress message size limit",
        "No artificial size assertion or cap is imposed on the mediaData or imageUrl Text fields in the post record or createPost function",
        "A comment documents the effective limit near the mediaData field",
        "The backend returns a structured #err result (not a trap) if any validation fails"
      ]
    }
  ],
  "constraints": [
    "Do not exceed the ICP ingress message size limit (~2 MB per call) for backend submissions — the frontend 10 MB limit applies to file selection/preview; actual upload payload must remain within ICP limits",
    "Do not modify files under frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, or frontend/src/components/ui"
  ],
  "nonGoals": [
    "Implementing chunked or asset canister storage for files exceeding the ICP ingress limit",
    "Changing the CreateReelPage file size limit (already set to 10 MB in a prior feature)",
    "Adding new file upload fields to pages that do not currently have them"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}